# FileWrite
Func _FileWriteToLine_Optim($sFilePath, $iLine, $sText, $bOverWrite = False, $bFill = False)     If $bOverWrite = Default Then $bOverWrite = False     If $bFill = Default Then $bFill = False     If Not FileExists($sFilePath) Then Return SetError(2, 0, 0)     If $iLine &lt;= 0 Then Return SetError(4, 0, 0)     If Not (IsBool($bOverWrite) Or $bOverWrite = 0 Or $bOverWrite = 1) Then Return SetError(5, 0, 0)     If Not IsString($sText) Then         $sText = String($sText)         If $sText = "" Then Return SetError(6, 0, 0)     EndIf     If Not IsBool($bFill) Then Return SetError(7, 0, 0)     ; Read current file     Local $sData = FileRead($sFilePath)     StringReplace($sData,@CRLF, '', 0, $STR_CASESENSE) ; get number of lines     Local $iLinesOrig = @extended + 1     ; If Fill option set     If $bFill Then         ; If required resize number of lines to allow line to be written         If $iLinesOrig &lt; $iLine Then             Local $sAddedLines = ""             For $i = 1 To $iLine - $iLinesOrig                 $sAddedLines &amp;= @CRLF             Next             $sData &amp;= $sAddedLines             $iLinesOrig = $iLine         EndIf     Else         If ($iLinesOrig) &lt; $iLine Then Return SetError(1, 0, 0)     EndIf      $poz2 = StringInStr($sData, @CRLF, $STR_CASESENSE, $iLine)     If $iLine > 1 Then         $poz1 = StringInStr($sData, @CRLF, $STR_CASESENSE, -1, $poz2 - 1)         $sLine_orig = StringMid($sData, $poz1 + 2, $poz2 - ($poz1 + 2))     Else         $sLine_orig = StringLeft($sData, $poz2 - 1)     EndIf      ; Write specific line - and either replace or insert     $sLine = ($bOverWrite ? $sText : $sText &amp; @CRLF &amp; $sLine_orig)     ; insert new line to original content     If $iLine > 1 Then         $sData = StringLeft($sData, $poz1 + 2 - 1) &amp; $sLine &amp; StringMid($sData, $poz2)     Else         $sData = $sLine &amp; StringMid($sData, $poz2)     EndIf     ; Write data to file     Local $hFileOpen = FileOpen($sFilePath, FileGetEncoding($sFilePath) + $FO_OVERWRITE)     If $hFileOpen = -1 Then Return SetError(3, 0, 0)     FileWrite($hFileOpen, $sData)     FileClose($hFileOpen)     Return 1 EndFunc   ;==>_FileWriteToLine
